{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/lightbox.js","../src/js/pagination.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_KEY = '49682443-1b8cbf37abce8b98fc4249c61';\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\nconst DEFAULT_PER_PAGE = 40;\r\n\r\nfunction apiService() {\r\n    const service = {\r\n        searchQuery: '',\r\n        page: 1,\r\n        PER_PAGE: DEFAULT_PER_PAGE,\r\n    };\r\n\r\n    const fetchGallery = async () => {\r\n        try {\r\n            const response = await axios.get(BASE_URL, {\r\n                params: {\r\n                    key: API_KEY,\r\n                    q: service.searchQuery,\r\n                    image_type: 'photo',\r\n                    orientation: 'horizontal',\r\n                    safesearch: true,\r\n                    page: service.page,\r\n                    per_page: service.PER_PAGE,\r\n                },\r\n            });\r\n            return response.data;\r\n        } catch (error) {\r\n            console.error(error);\r\n            throw new Error('Failed to fetch data');\r\n        }\r\n    };\r\n\r\n    const incrementPage = () => {\r\n        service.page += 1;\r\n    };\r\n\r\n    const resetPage = () => {\r\n        service.page = 1;\r\n    };\r\n\r\n    const getQuery = () => {\r\n        return service.searchQuery;\r\n    };\r\n\r\n    const setQuery = (newQuery) => {\r\n        service.searchQuery = newQuery;\r\n        resetPage();\r\n    };\r\n\r\n    const getPage = (currentPage) => {\r\n        service.page = currentPage;\r\n    };\r\n\r\n    return {\r\n        fetchGallery,\r\n        incrementPage,\r\n        resetPage,\r\n        getQuery,\r\n        setQuery,\r\n        getPage,\r\n    };\r\n}\r\n\r\nexport default apiService();","import SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nlet lightbox = new SimpleLightbox('.photo-card a', {\r\n    captions: true,\r\n    captionsData: 'alt',\r\n    captionDelay: 250,\r\n});\r\n\r\nexport { lightbox };","import apiService from './api';\r\nimport { lightbox } from './lightbox';\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nconst searchButton = document.getElementById('search-button');\r\nconst galleryContainer = document.querySelector('.gallery');\r\nconst searchQueryInput = document.getElementById('search-bar');\r\nconst paginationContainer = document.getElementById('pagination-container')\r\nconst paginationButtons = document.getElementById('pagination-numbers');\r\nconst prevButton = document.getElementById('prev-button');\r\nconst nextButton = document.getElementById('next-button');\r\n\r\nlet isShown = 0;\r\nlet isFirstSearch = true;\r\nlet currentPage = 1;\r\nlet query = ''\r\n\r\nsearchButton.addEventListener(\"click\", function (event) {\r\n    event.preventDefault();\r\n    onSearch();\r\n    isFirstSearch = true;\r\n    currentPage = 1;\r\n});\r\n\r\nsearchQueryInput.addEventListener(\"keydown\", function (event) {\r\n    if (event.key === 'Enter') {\r\n        event.preventDefault();\r\n        onSearch();\r\n    }\r\n    isFirstSearch = true;\r\n    currentPage = 1;\r\n});\r\n\r\nprevButton.addEventListener('click', () => setCurrentPage(currentPage - 1));\r\nnextButton.addEventListener('click', () => setCurrentPage(currentPage + 1));\r\n\r\nasync function onSearch() {\r\n    const searchQuery = searchQueryInput.value.trim();\r\n\r\n    apiService.setQuery(searchQuery);\r\n\r\n    if (searchQuery === '') {\r\n        showToast('warning', 'Будь ласка, заповніть поле пошуку');\r\n        paginationContainer.classList.add('is-hidden')\r\n        return;\r\n    }\r\n\r\n    if (searchQuery === query) {\r\n        showToast('warning', 'Будь ласка, змініть або введіть нове значення для пошуку.');\r\n        return;\r\n    }\r\n\r\n    apiService.resetPage();\r\n    query = searchQuery;\r\n    isShown = 0;\r\n    await fetchGallery(1);\r\n}\r\n\r\nasync function fetchGallery(currentPage) {\r\n    try {\r\n        apiService.getPage(currentPage)\r\n        const result = await apiService.fetchGallery();\r\n        const { hits, totalHits } = result;\r\n\r\n        if (isFirstSearch && !hits.length) {\r\n            showToast('error', 'Вибачте, немає зображень, які відповідають вашому пошуковому запиту. Будь ласка спробуйте ще раз.');\r\n            paginationContainer.classList.add('is-hidden')\r\n            return;\r\n        }\r\n\r\n        if (isFirstSearch && isShown < totalHits) {\r\n            showToast('success', `Ура! Ми знайшли ${totalHits} зображень!`);\r\n            setupPagination({ hits, totalHits });\r\n            isFirstSearch = false;\r\n        }\r\n\r\n        galleryContainer.innerHTML = '';\r\n        onRenderGallery(hits);\r\n        isShown += hits.length;\r\n\r\n        if (isFirstSearch && isShown >= totalHits) {\r\n            showToast('info', \"Ви досягли кінця результатів пошуку.\");\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching gallery:', error);\r\n        showToast('error', 'Під час отримання галереї зображень сталася помилка.');\r\n    }\r\n}\r\n\r\nfunction onRenderGallery(elements) {\r\n    const markup = elements\r\n        .map(({ webformatURL, largeImageURL, tags, likes, views, downloads }) => `\r\n      <div class=\"photo-card\">\r\n        <a href=\"${largeImageURL}\">\r\n          <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\r\n        </a>\r\n        <div class=\"info\">\r\n          <p class=\"info-item\"><b>Вподобайки</b><span class=\"info__span\">${likes}</span></p>\r\n          <p class=\"info-item\"><b>Перегляди</b><span class=\"info__span\">${views}</span></p>\r\n          <p class=\"info-item\"><b>Завантаження</b><span class=\"info__span\">${downloads}</span></p>\r\n        </div>\r\n      </div>`\r\n        )\r\n        .join('');\r\n\r\n    galleryContainer.insertAdjacentHTML('beforeend', markup);\r\n    lightbox.refresh();\r\n}\r\n\r\nfunction setupPagination({ hits, totalHits }) {\r\n\r\n    const pageCount = Math.ceil(totalHits / hits.length);\r\n\r\n    paginationButtons.innerHTML = '';\r\n\r\n    for (let i = 1; i <= pageCount; i++) {\r\n        const pageNumber = document.createElement('button');\r\n        pageNumber.className = 'pagination-number';\r\n        pageNumber.textContent = i;\r\n\r\n        paginationButtons.appendChild(pageNumber);\r\n\r\n        pageCount > 1 ? paginationContainer.classList.remove('is-hidden') : paginationContainer.classList.add('is-hidden')\r\n\r\n        pageNumber.addEventListener('click', () => {\r\n            setCurrentPage(i);\r\n            isFirstSearch = false;\r\n        });\r\n    }\r\n    handlePageButtonsStatus();\r\n    handleActivePageNumber();\r\n}\r\n\r\nasync function setCurrentPage(i) {\r\n    currentPage = i;\r\n    await fetchGallery(currentPage);\r\n    scrollToTop();\r\n    handlePageButtonsStatus();\r\n    handleActivePageNumber();\r\n}\r\n\r\nconst disableButton = (button) => {\r\n    button.classList.add(\"disabled\");\r\n    button.setAttribute(\"disabled\", true);\r\n};\r\n\r\nconst enableButton = (button) => {\r\n    button.classList.remove(\"disabled\");\r\n    button.removeAttribute(\"disabled\");\r\n};\r\n\r\nconst handlePageButtonsStatus = () => {\r\n    if (currentPage === 1) {\r\n        disableButton(prevButton);\r\n    } else {\r\n        enableButton(prevButton);\r\n    }\r\n\r\n    if (currentPage === paginationButtons.children.length) {\r\n        disableButton(nextButton);\r\n    } else {\r\n        enableButton(nextButton);\r\n    }\r\n};\r\n\r\nconst handleActivePageNumber = () => {\r\n    document.querySelectorAll(\".pagination-number\").forEach((button, page) => {\r\n        button.classList.remove(\"active\");\r\n        if (page + 1 === currentPage) {\r\n            button.classList.add(\"active\");\r\n        }\r\n    });\r\n};\r\n\r\nfunction showToast(type, message) {\r\n    iziToast[type]({\r\n        title: type.charAt(0).toUpperCase() + type.slice(1),\r\n        message: message,\r\n        position: 'topRight',\r\n        color: type === 'success' ? 'green' : type === 'warning' ? 'yellow' : type === 'error' ? 'red' : 'blue',\r\n        timeout: 2000,\r\n        closeOnEscape: true,\r\n        closeOnClick: true,\r\n    });\r\n}\r\n\r\nfunction scrollToTop() {\r\n    window.scrollTo({\r\n        top: 0,\r\n        behavior: 'auto',\r\n    });\r\n}"],"names":["API_KEY","BASE_URL","DEFAULT_PER_PAGE","apiService","service","fetchGallery","axios","error","incrementPage","resetPage","newQuery","currentPage","apiService$1","lightbox","SimpleLightbox","searchButton","galleryContainer","searchQueryInput","paginationContainer","paginationButtons","prevButton","nextButton","isShown","isFirstSearch","query","event","onSearch","setCurrentPage","searchQuery","showToast","result","hits","totalHits","setupPagination","onRenderGallery","elements","markup","webformatURL","largeImageURL","tags","likes","views","downloads","pageCount","i","pageNumber","handlePageButtonsStatus","handleActivePageNumber","scrollToTop","disableButton","button","enableButton","page","type","message","iziToast"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,2BACXC,EAAmB,GAEzB,SAASC,GAAa,CAClB,MAAMC,EAAU,CACZ,YAAa,GACb,KAAM,EACN,SAAUF,CAClB,EAEUG,EAAe,SAAY,CAC7B,GAAI,CAYA,OAXiB,MAAMC,EAAM,IAAIL,EAAU,CACvC,OAAQ,CACJ,IAAKD,EACL,EAAGI,EAAQ,YACX,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMA,EAAQ,KACd,SAAUA,EAAQ,QACrB,CACjB,CAAa,GACe,IACnB,OAAQG,EAAO,CACZ,cAAQ,MAAMA,CAAK,EACb,IAAI,MAAM,sBAAsB,CACzC,CACT,EAEUC,EAAgB,IAAM,CACxBJ,EAAQ,MAAQ,CACxB,EAEUK,EAAY,IAAM,CACpBL,EAAQ,KAAO,CACvB,EAeI,MAAO,CACH,aAAAC,EACA,cAAAG,EACA,UAAAC,EACA,SAjBa,IACNL,EAAQ,YAiBf,SAdcM,GAAa,CAC3BN,EAAQ,YAAcM,EACtBD,GACR,EAYQ,QAVaE,GAAgB,CAC7BP,EAAQ,KAAOO,CACvB,CASA,CACA,CAEA,MAAAC,EAAeT,EAAY,EC7D3B,IAAIU,EAAW,IAAIC,EAAe,gBAAiB,CAC/C,SAAU,GACV,aAAc,MACd,aAAc,GAClB,CAAC,ECFD,MAAMC,EAAe,SAAS,eAAe,eAAe,EACtDC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAmB,SAAS,eAAe,YAAY,EACvDC,EAAsB,SAAS,eAAe,sBAAsB,EACpEC,EAAoB,SAAS,eAAe,oBAAoB,EAChEC,EAAa,SAAS,eAAe,aAAa,EAClDC,EAAa,SAAS,eAAe,aAAa,EAExD,IAAIC,EAAU,EACVC,EAAgB,GAChBZ,EAAc,EACda,EAAQ,GAEZT,EAAa,iBAAiB,QAAS,SAAUU,EAAO,CACpDA,EAAM,eAAc,EACpBC,IACAH,EAAgB,GAChBZ,EAAc,CAClB,CAAC,EAEDM,EAAiB,iBAAiB,UAAW,SAAUQ,EAAO,CACtDA,EAAM,MAAQ,UACdA,EAAM,eAAc,EACpBC,KAEJH,EAAgB,GAChBZ,EAAc,CAClB,CAAC,EAEDS,EAAW,iBAAiB,QAAS,IAAMO,EAAehB,EAAc,CAAC,CAAC,EAC1EU,EAAW,iBAAiB,QAAS,IAAMM,EAAehB,EAAc,CAAC,CAAC,EAE1E,eAAee,GAAW,CACtB,MAAME,EAAcX,EAAiB,MAAM,KAAI,EAI/C,GAFAd,EAAW,SAASyB,CAAW,EAE3BA,IAAgB,GAAI,CACpBC,EAAU,UAAW,mCAAmC,EACxDX,EAAoB,UAAU,IAAI,WAAW,EAC7C,MACH,CAED,GAAIU,IAAgBJ,EAAO,CACvBK,EAAU,UAAW,2DAA2D,EAChF,MACH,CAED1B,EAAW,UAAS,EACpBqB,EAAQI,EACRN,EAAU,EACV,MAAMjB,EAAa,CAAC,CACxB,CAEA,eAAeA,EAAaM,EAAa,CACrC,GAAI,CACAR,EAAW,QAAQQ,CAAW,EAC9B,MAAMmB,EAAS,MAAM3B,EAAW,eAC1B,CAAE,KAAA4B,EAAM,UAAAC,CAAW,EAAGF,EAE5B,GAAIP,GAAiB,CAACQ,EAAK,OAAQ,CAC/BF,EAAU,QAAS,mGAAmG,EACtHX,EAAoB,UAAU,IAAI,WAAW,EAC7C,MACH,CAEGK,GAAiBD,EAAUU,IAC3BH,EAAU,UAAW,mBAAmBG,CAAS,aAAa,EAC9DC,EAAgB,CAAE,KAAAF,EAAM,UAAAC,CAAS,CAAE,EACnCT,EAAgB,IAGpBP,EAAiB,UAAY,GAC7BkB,EAAgBH,CAAI,EACpBT,GAAWS,EAAK,OAEZR,GAAiBD,GAAWU,GAC5BH,EAAU,OAAQ,sCAAsC,CAE/D,OAAQtB,EAAO,CACZ,QAAQ,MAAM,0BAA2BA,CAAK,EAC9CsB,EAAU,QAAS,sDAAsD,CAC5E,CACL,CAEA,SAASK,EAAgBC,EAAU,CAC/B,MAAMC,EAASD,EACV,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,UAAAC,CAAS,IAAO;AAAA;AAAA,mBAE9DJ,CAAa;AAAA,wCACQD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,2EAGSC,CAAK;AAAA,0EACNC,CAAK;AAAA,6EACFC,CAAS;AAAA;AAAA,aAG7E,EACA,KAAK,EAAE,EAEZ1B,EAAiB,mBAAmB,YAAaoB,CAAM,EACvDvB,EAAS,QAAO,CACpB,CAEA,SAASoB,EAAgB,CAAE,KAAAF,EAAM,UAAAC,GAAa,CAE1C,MAAMW,EAAY,KAAK,KAAKX,EAAYD,EAAK,MAAM,EAEnDZ,EAAkB,UAAY,GAE9B,QAASyB,EAAI,EAAGA,GAAKD,EAAWC,IAAK,CACjC,MAAMC,EAAa,SAAS,cAAc,QAAQ,EAClDA,EAAW,UAAY,oBACvBA,EAAW,YAAcD,EAEzBzB,EAAkB,YAAY0B,CAAU,EAExCF,EAAY,EAAIzB,EAAoB,UAAU,OAAO,WAAW,EAAIA,EAAoB,UAAU,IAAI,WAAW,EAEjH2B,EAAW,iBAAiB,QAAS,IAAM,CACvClB,EAAeiB,CAAC,EAChBrB,EAAgB,EAC5B,CAAS,CACJ,CACDuB,IACAC,GACJ,CAEA,eAAepB,EAAeiB,EAAG,CAC7BjC,EAAciC,EACd,MAAMvC,EAAaM,CAAW,EAC9BqC,IACAF,IACAC,GACJ,CAEA,MAAME,EAAiBC,GAAW,CAC9BA,EAAO,UAAU,IAAI,UAAU,EAC/BA,EAAO,aAAa,WAAY,EAAI,CACxC,EAEMC,EAAgBD,GAAW,CAC7BA,EAAO,UAAU,OAAO,UAAU,EAClCA,EAAO,gBAAgB,UAAU,CACrC,EAEMJ,EAA0B,IAAM,CAC9BnC,IAAgB,EAChBsC,EAAc7B,CAAU,EAExB+B,EAAa/B,CAAU,EAGvBT,IAAgBQ,EAAkB,SAAS,OAC3C8B,EAAc5B,CAAU,EAExB8B,EAAa9B,CAAU,CAE/B,EAEM0B,EAAyB,IAAM,CACjC,SAAS,iBAAiB,oBAAoB,EAAE,QAAQ,CAACG,EAAQE,IAAS,CACtEF,EAAO,UAAU,OAAO,QAAQ,EAC5BE,EAAO,IAAMzC,GACbuC,EAAO,UAAU,IAAI,QAAQ,CAEzC,CAAK,CACL,EAEA,SAASrB,EAAUwB,EAAMC,EAAS,CAC9BC,EAASF,CAAI,EAAE,CACX,MAAOA,EAAK,OAAO,CAAC,EAAE,cAAgBA,EAAK,MAAM,CAAC,EAClD,QAASC,EACT,SAAU,WACV,MAAOD,IAAS,UAAY,QAAUA,IAAS,UAAY,SAAWA,IAAS,QAAU,MAAQ,OACjG,QAAS,IACT,cAAe,GACf,aAAc,EACtB,CAAK,CACL,CAEA,SAASL,GAAc,CACnB,OAAO,SAAS,CACZ,IAAK,EACL,SAAU,MAClB,CAAK,CACL"}